import mysql.connector as sql

c=0

def create():
    global c
    con = sql.connect(host="localhost",user="root",password="bbit@123")
    cur=con.cursor()
    print("Initialising database")
    cur.execute("create database project2")
    c+=1
    print(c)
    cur.execute("use project2")
    c+=1
    print(c)
    cur.execute("CREATE TABLE customer_details (CUSTOMER_ID varchar(12) NOT NULL PRIMARY KEY,CUSTOMER_NAME varchar(30) UNIQUE KEY,DOA varchar(10) ,DOB varchar(10) ,AC_NO varchar(12) ,BALANCE float ,PASSWORD varchar(12) ,GENDER varchar(7))")
    c+=1
    print(c)
    cur.execute("CREATE TABLE admin_details (CUSTOMER_ID varchar(10) REFERENCES customer_details(CUSTOMER_ID) ,B_NO varchar(3) ,CREDIT_AMOUNT float ,DEBIT_AMOUNT float ,ACCOUNT_TYPE varchar(10))")
    c+=1
    print(c)
    cur.execute("CREATE TABLE transaction (CUSTOMER_ID varchar(12) REFERENCES customer_details(CUSTOMER_ID) ,TRANSACTION_ID varchar(20),TYPE varchar(10),CREDIT_AMT float,DEBIT_AMT float,2NDCUSTOMER_ID varchar(12),DATE varchar(12))")
    c+=1
    print(c)
    A = [('166789865A','RAJESH KUMAR','12_09_2009','30_12_1987','9809876310',56000,'PASSWORD*9','MALE'),('166789865B','MANISH PANDEY','14_06_2010','31_11_1982','9809876311',321098,'PASREW43*2','MALE'),('166789865D','SOMA DAS','14_07_2010','09_11_1983','9809876313',12900,'UYTREWQP%','FEMALE'),('166789865E','SOHAM DAS','25_07_2014','09_05_1980','9809876314',1543,'OPIUYTR9*&','MALE'),('166789865G','NEHA DAS','22_03_2015','21_06_1981','9889876316',231409,'KJIUYT09*&','FEMALE'),('166789865I','SONALI SHARMA','23_09_2005','27_10_1981','9809876318',23190,'BVTRESD*98','FEMALE'),('166789865K','SRIDU RAJ','16_07_2015','16_01_1982','9809876320',21340,'KLJHGTRE#4','MALE'),('166789865M','VAMIKA SHAW','29_07_2016','19_10_1984','9809876322',32100,'GHYTRESD@1','FEMALE'),('166789865N','VINETA YASMIN','21_09_2016','20_11_1984','9809876323',765430,'FGTREDSW^3','FEMALE'),('166789865Q','JAYESH RANA','19_11_2020','13_12_1981','9809876326',90901,'RTEDSWAQ*7','MALE'),('166789865R','AMINA KHATUN','29_12_2014','18_12_1982','9809876327',95400,'HYTRFGVC%9','FEMALE'),('166789865S','NUSRAT KHATUN','20_11_2017','16_09_1983','9809876328',80900,'HJRFD5','FEMALE'),('166789865T','AKASH NIGAM','21_01_2007','26_05_1983','9809876329',809005,'GHYTRDFE*1','MALE'),('166789865U','PAN NIGAM','22_06_2010','24_02_1983','9809876330',84000,'JHUYTF%4','MALE'),('166789865V','SHANTI BHOWMICK','12_06_2010','14_02_1984','9809876331',84050,'HJUYTREW*0','MALE'),('166789865W','RIYA BHOWMICK','22_06_2011','24_09_1982','9809876332',908760,'JHUYTRE*^0','FEMALE'),('166789865X','RIYASHI KISHAN','12_08_2009','25_10_1982','9809876333',500000,'YUIOPOIU*7','FEMALE'),('166789865Y','RIYU SINGH','18_08_2010','15_11_1982','9809876334',500040,'UIYTREDF&2','MALE'),('188620128B','Shivam Pati','06_10_2023','15_06_2005','9571088005',20000,'animefan','MALE'),('247649824W','Rohit Das','07_10_2023','05_04_2001','5342010266',17000,'12345','MALE'),('345646012H','Rishiraj Das Ghosh','20_09_2023','13_07_2005','3821865370',82000,'mnopqrst','MALE'),('433788023O','Dilip Ghosh','01_10_2023','10_05_1966','5413198615',45000,'hello@123','MALE'),('553998552Y','Ayan Jana','06_10_2023','09_08_2006','8182225718',500,'ayan123','MALE'),('731000879Q','Amit Mehate','05_10_2023','02_08_2001','6546777317',12200,'mango1','MALE'),('777777263G','Kalyani Ghosh','10_01_2023','05_04_1988','7083278424',12000,'kalna123','FEMALE'),('880852458F','Sourangshu Ghosh','19_09_2023','06_05_2006','70492736',31000,'ababcd','MALE'),('950556726L','Tamaghna kundu','24_09_2023','06_08_2005','9942370289',9950000,'firefly','MALE'),('972899170H','Sk. Aftab','06_10_2023','06_11_2005','8234608340',50000,'rupsa123','MALE')]
    B = [('166789865A','B02',57000,1000,'CURRENT'),('166789865B','B01',324000,2902,'SAVINGS'),('166789865D','B05',18000,100,'CURRENT'),('166789865E','B07',2000,457,'SAVINGS'),('166789865G','B89',232000,591,'CURRENT'),('166789865K','B03',22000,660,'SAVINGS'),('166789865M','B06',32800,700,'CURRENT'),('166789865N','B05',768000,2570,'CURRENT'),('166789865R','B03',98000,2600,'SAVINGS'),('166789865S','B09',90000,9100,'SAVINGS'),('166789865T','B01',900000,90995,'SAVINGS'),('166789865U','B07',88000,4000,'CURRENT'),('166789865V','B89',90000,5950,'CURRENT'),('166789865W','B04',910000,1240,'CURRENT'),('166789865X','B05',510000,10000,'SAVINGS'),('166789865Y','B08',510050,10010,'CURRENT'),('345646012H','B03',102000,10000,'SAVINGS'),('880852458F','B05',182000,119000,'SAVINGS'),('950556726L','B01',10010000,50000,'SAVINGS'),('433788023O','B07',65000,20000,'SAVINGS'),('816910863A','B01',1000,0,'CURRENT'),('98228066Q','B07',787,0,'SAVINGS'),('777777263G','B01',22000,0,'SAVINGS'),('731000879Q','B05',12200,0,'SAVINGS'),('972899170H','B06',50000,0,'SAVINGS'),('188620128B','B01',20000,0,'SAVINGS'),('553998552Y','B06',12500,12000,'SAVINGS'),('247649824W','B08',17000,0,'CURRENT')]
    C = [('166789865A','225253395258ZYYIRI','DEPOSITE',57000,"NULL","NULL",'01_10_2023'),('166789865B','863327188860LKPPTS','DEPOSITE',324000,"NULL","NULL",'01_10_2023'),('166789865C','299322270940VUEGRX','DEPOSITE',50000,"NULL","NULL",'01_10_2023'),('166789865D','539982180706OFUQML','DEPOSITE',18000,"NULL","NULL",'01_10_2023'),('166789865E','450729243769GFSIKT','DEPOSITE',2000,"NULL","NULL",'01_10_2023'),('166789865F','560814361189UYJSCQ','DEPOSITE',200000,"NULL","NULL",'01_10_2023'),('166789865G','528800039039ZUULXZ','DEPOSITE',232000,"NULL","NULL",'01_10_2023'),('166789865H','506297306643PLMOYJ','DEPOSITE',25000,"NULL","NULL",'01_10_2023'),('166789865J','414190713146RKMZCE','DEPOSITE',899000,"NULL","NULL",'01_10_2023'),('166789865K','941495990166UDKVLX','DEPOSITE',22000,"NULL","NULL",'01_10_2023'),('166789865L','80272808358NCYOWU','DEPOSITE',99000,"NULL","NULL",'01_10_2023'),('166789865M','123607133270PTHAZI','DEPOSITE',32800,"NULL","NULL",'01_10_2023'),('166789865N','55324135991DNHHKJ','DEPOSITE',768000,"NULL","NULL",'01_10_2023'),('166789865P','104954392586KHWTNP','DEPOSITE',99000,"NULL","NULL",'01_10_2023'),('166789865R','626524282318QIDKDZ','DEPOSITE',98000,"NULL","NULL",'01_10_2023'),('166789865I','440497372524OYNZHM','DEPOSITE',24000,"NULL","NULL",'01_10_2023'),('166789865O','992241459973FYCPEM','DEPOSITE',98000,"NULL","NULL",'01_10_2023'),('166789865S','564223548286JYLZJO','DEPOSITE',90000,"NULL","NULL",'01_10_2023'),('166789865T','122569761687SEPHOY','DEPOSITE',900000,"NULL","NULL",'01_10_2023'),('166789865U','775727838311HYAOKA','DEPOSITE',88000,"NULL","NULL",'01_10_2023'),('166789865V','38288070183RUQCHH','DEPOSITE',90000,"NULL","NULL",'01_10_2023'),('166789865W','996479093246AHWRUN','DEPOSITE',910000,"NULL","NULL",'01_10_2023'),('166789865X','381656832510AHSDWX','DEPOSITE',510000,"NULL","NULL",'01_10_2023'),('166789865Y','19862477646GHXPUE','DEPOSITE',510050,"NULL","NULL",'01_10_2023'),('345646012H','12193591527AEXWRB','DEPOSITE',90000,"NULL","NULL",'01_10_2023'),('880852458F','890000801221OHUZKU','DEPOSITE',100000,"NULL","NULL",'01_10_2023'),('950556726L','291870597147JEZEMT','DEPOSITE',10000000,"NULL","NULL",'01_10_2023'),('433788023O','955030719580JJJSXO','DEPOSITE',10000,"NULL","NULL",'01_10_2023'),('816910863A','433882012334INCPLW','DEPOSITE',1000,"NULL","NULL",'01_10_2023'),('98228066Q','428912294875KNKQRP','DEPOSITE',787,"NULL","NULL",'01_10_2023'),('777777263G','694327223325HJYSKH','DEPOSITE',12000,"NULL","NULL",'01_10_2023'),('166789865A','162511230704ECXCLQ','WITHDRAW',"NULL",1000,"NULL",'01_10_2023'),('166789865B','898564542193KOPXIR','WITHDRAW',"NULL",2902,"NULL",'01_10_2023'),('166789865C','974038467020CQXPKZ','WITHDRAW',"NULL",4650,"NULL",'01_10_2023'),('166789865D','27638754394TGZSWA','WITHDRAW',"NULL",100,"NULL",'01_10_2023'),('166789865E','257514751199LVISQA','WITHDRAW',"NULL",457,"NULL",'01_10_2023'),('166789865F','106251945822MQNYAE','WITHDRAW',"NULL",45692,"NULL",'01_10_2023'),('166789865G','999723124597SBSFAM','WITHDRAW',"NULL",591,"NULL",'01_10_2023'),('166789865H','569452187380MJLAPF','WITHDRAW',"NULL",12700,"NULL",'01_10_2023'),('166789865J','531218743604EFSUGQ','WITHDRAW',"NULL",1350,"NULL",'01_10_2023'),('166789865K','464744134533QGAQVX','WITHDRAW',"NULL",660,"NULL",'01_10_2023'),('166789865L','760596237264IPAWJY','WITHDRAW',"NULL",8130,"NULL",'01_10_2023'),('166789865M','653457059096BTWIPZ','WITHDRAW',"NULL",700,"NULL",'01_10_2023'),('166789865N','160418363127UURCZS','WITHDRAW',"NULL",2570,"NULL",'01_10_2023'),('166789865P','52673967637JHQQUC','WITHDRAW',"NULL",8920,"NULL",'01_10_2023'),('166789865R','42652794080DMWXSU','WITHDRAW',"NULL",2600,"NULL",'01_10_2023'),('166789865I','15096750553IOVIMV','WITHDRAW',"NULL",810,"NULL",'01_10_2023'),('166789865O','218545114933UTYQWD','WITHDRAW',"NULL",8000,"NULL",'01_10_2023'),('166789865S','500070871745VIZFGJ','WITHDRAW',"NULL",9100,"NULL",'01_10_2023'),('166789865T','792895136758TGUKAG','WITHDRAW',"NULL",90995,"NULL",'01_10_2023'),('166789865U','999949505981TKHNYS','WITHDRAW',"NULL",4000,"NULL",'01_10_2023'),('166789865V','680763256549EWGLLU','WITHDRAW',"NULL",5950,"NULL",'01_10_2023'),('166789865W','110464567519CKYTUS','WITHDRAW',"NULL",1240,"NULL",'01_10_2023'),('166789865X','967334999799KZMOEM','WITHDRAW',"NULL",10000,"NULL",'01_10_2023'),('166789865Y','960954756885APSRMA','WITHDRAW',"NULL",10010,"NULL",'01_10_2023'),('345646012H','840885137718EPLEBR','WITHDRAW',"NULL",10000,"NULL",'01_10_2023'),('880852458F','839641254932WIRAPK','WITHDRAW',"NULL",50000,"NULL",'01_10_2023'),('880852458F','690792796396MBQOBY','WITHDRAW',"NULL",7000,"NULL",'2_10_2023'),('880852458F','375446522162ILRDGA','DEPOSITE',8000,"NULL","NULL",'2_10_2023'),('880852458F','877065579329SDMURV','SENT',"NULL",10000,'777777263G','2_10_2023'),('777777263G','877065579329SDMURV','RECEIVED',10000,"NULL",'880852458F','2_10_2023'),('433788023O','672218619653TNTRWY','DEPOSITE',50000,"NULL","NULL",'2_10_2023'),('433788023O','200171255560XVJRKV','SENT',"NULL",20000,'880852458F','2_10_2023'),('880852458F','200171255560XVJRKV','RECEIVED',20000,"NULL",'433788023O','2_10_2023'),('880852458F','6979475716EYIRWK','DEPOSITE',10000,"NULL","NULL",'4_10_2023'),('880852458F','313391634909OAYGHV','WITHDRAW',"NULL",5000,"NULL",'4_10_2023'),('433788023O','310748080666SQNKVS','DEPOSITE',5000,"NULL","NULL",'5_10_2023'),('731000879Q','433223140261BIBBTO','DEPOSITE',12200,"NULL","NULL",'05_10_2023'),('972899170H','858012242608CGLGCW','DEPOSITE',50000,"NULL","NULL",'06_10_2023'),('188620128B','54603701051PWAMBU','DEPOSITE',20000,"NULL","NULL",'06_10_2023'),('553998552Y','839297889955GQKYZM','DEPOSITE',12500,"NULL","NULL",'06_10_2023'),('553998552Y','698414417462OUXEVY','SENT',"NULL",12000,'880852458F','6_10_2023'),('880852458F','698414417462OUXEVY','RECEIVED',12000,"NULL",'553998552Y','6_10_2023'),('880852458F','85860978340CAMKZF','WITHDRAW',"NULL",5000,"NULL",'6_10_2023'),('880852458F','390365898705TAFNFZ','DEPOSITE',10000,"NULL","NULL",'6_10_2023'),('880852458F','28505969512LSRVQC','WITHDRAW',"NULL",1000,"NULL",'6_10_2023'),('880852458F','535254837087BDEWNF','DEPOSITE',2000,"NULL","NULL",'6_10_2023'),('880852458F','726360784499YKJXQT','SENT',"NULL",10000,'950556726L','6_10_2023'),('950556726L','726360784499YKJXQT','RECEIVED',10000,"NULL",'880852458F','6_10_2023'),('950556726L','120966864961PHCABG','WITHDRAW',"NULL",50000,"NULL",'6_10_2023'),('880852458F','957958251356SZPUST','WITHDRAW',"NULL",5000,"NULL",'6_10_2023'),('880852458F','725040645374QJSRMS','DEPOSITE',10000,"NULL","NULL",'6_10_2023'),('880852458F','442620629561DEHETB','SENT',"NULL",10000,'345646012H','6_10_2023'),('345646012H','442620629561DEHETB','RECEIVED',10000,"NULL",'880852458F','6_10_2023'),('880852458F','814417810490VPDTCU','SENT',"NULL",2000,'345646012H','6_10_2023'),('345646012H','814417810490VPDTCU','RECEIVED',2000,"NULL",'880852458F','6_10_2023'),('808392450C','845283963921BZEMJR','DEPOSITE',12000,"NULL","NULL",'08_10_2023'),('880852458F','671582983632OZFLIP','WITHDRAW',"NULL",2000,"NULL",'6_10_2023'),('880852458F','863067868487NDXRDD','SENT',"NULL",5000,'808392450C','6_10_2023'),('808392450C','863067868487NDXRDD','RECEIVED',5000,"NULL",'880852458F','6_10_2023'),('247649824W','239850290594FPSSBZ','DEPOSITE',12000,"NULL","NULL",'07_10_2023'),('880852458F','509738650482SYPKVR','WITHDRAW',"NULL",1000,"NULL",'7_10_2023'),('880852458F','678189743075BAPGPV','DEPOSITE',10000,"NULL","NULL",'7_10_2023'),('880852458F','113032639038BINOFD','SENT',"NULL",5000,'247649824W','7_10_2023'),('247649824W','113032639038BINOFD','RECEIVED',5000,"NULL",'880852458F','7_10_2023'),('880852458F','809118183967RUAEVI','WITHDRAW',"NULL",1000,"NULL",'7_10_2023')]
    for i in A:
        cur.execute("INSERT INTO customer_details (CUSTOMER_ID,CUSTOMER_NAME,DOA,DOB,AC_NO,BALANCE,PASSWORD,GENDER) VALUES('{}','{}','{}','{}','{}',{},'{}','{}')".format(i[0],i[1].upper(),i[2],i[3],i[4],i[5],i[6],i[7]))
        c+=1
        print(c)
    for i in B:
        cur.execute("INSERT INTO admin_details (CUSTOMER_ID,B_NO,CREDIT_AMOUNT,DEBIT_AMOUNT,ACCOUNT_TYPE) VALUES('{}','{}',{},{},'{}')".format(i[0],i[1],i[2],i[3],i[4]))
        c+=1
        print(c)
    for i in C:
        cur.execute("INSERT INTO transaction (CUSTOMER_ID,TRANSACTION_ID,TYPE,CREDIT_AMT,DEBIT_AMT,2NDCUSTOMER_ID,DATE) VALUES('{}','{}','{}',{},{},'{}','{}')".format(i[0],i[1],i[2],i[3],i[4],i[5],i[6]))
        c+=1
        print(c)
    print("Done!")
    con.commit()

try:
    con = sql.connect(host="localhost",user="root",password="bbit@123",database="project2")
    cur=con.cursor()
    cur.execute("show tables")
    t = list(cur.fetchall())
    if t == [("admin_details",),("customer_details",),("transaction",)]:
        print("All good to go")
    else:
        cur.execute("drop database project2")
        con.commit()
        create()


except Exception as e:
    create()